<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kanji & Vocabulary Quiz</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: linear-gradient(to bottom, #b179b9, #b179b9);
      text-align: center;
    }

    h1 {
      font-size: 2.5rem;
      color: white;
      margin-bottom: 20px;
    }

    .btn {
      padding: 10px 20px;
      font-size: 1.2em;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: rgb(214, 169, 56);
      color: white;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      margin: 10px;
      min-width: 150px;
    }

    .choice-btn {
      background-color: white;
      color: black;
      border: 2px solid black;
    }

    .hidden {
      display: none;
    }

    .checkbox-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
      color: white;
      font-size: 1.2em;
    }

    .kanji {
      font-size: 6em;
      margin: 20px;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .choices {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .choice-option {
      background-color: white;
      color: black;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 8px 15px;
      font-size: 1.1em;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .choice-option:hover {
      background-color: #f0f0f0;
    }

    .score, .feedback {
      margin-top: 10px;
      font-size: 1.2em;
      color: white;
    }
  </style>
</head>
<body>

  <h1>Kanji & Vocabulary Quiz</h1>

  <!-- Choice Screen -->
  <div id="choiceScreen">
    <button class="btn choice-btn" onclick="selectCategory('kanji')">Kanji</button>
    <button class="btn choice-btn" onclick="selectCategory('vocab')">Vocabulary</button>
  </div>

  <!-- Checkbox Screen -->
  <div id="checkboxScreen" class="hidden">
    <div id="checkboxContainer" class="checkbox-group"></div>
    <button class="btn" onclick="startFromCheckbox()">Start</button>
    <button class="btn" onclick="goBackToChoice()">Back</button>
  </div>

  <!-- Game Screen -->
  <div id="gameScreen" class="hidden">
    <div class="kanji" id="kanji">?</div>
    <div class="choices" id="choices"></div>
    <div class="feedback" id="feedback"></div>
    <div class="score" id="score">Score: 0</div>
    <button class="btn" onclick="resetGame()">Restart</button>
    <button class="btn" onclick="goBackToCheckboxes()">Back</button>
  </div>

<script>
  const kanjiSets = {
    kanji1: [
      { kanji: "çŸ­ã„", reading: "ã¿ã˜ã‹ã„" },
      { kanji: "çŸ­å¤§", reading: "ãŸã‚“ã ã„" }
    ],
    kanji2: [
      { kanji: "çŸ­æ™‚é–“", reading: "ãŸã‚“ã˜ã‹ã‚“" },
      { kanji: "ä½ã„", reading: "ã²ãã„" }
    ],
    kanji3: [
      { kanji: "é•·ã„", reading: "ãªãŒã„" },
      { kanji: "æ³³ã", reading: "ãŠã‚ˆã" }
    ]
  };

  const vocabSets = {
    vocab1: [
{ kanji: "çŸ­ã„", reading: "ã¿ã˜ã‹ã„" },
{ kanji: "çŸ­å¤§", reading: "ãŸã‚“ã ã„" },
{ kanji: "çŸ­æ™‚é–“", reading: "ãŸã‚“ã˜ã‹ã‚“" },
{ kanji: "ä½ã„", reading: "ã²ãã„" },
{ kanji: "ä½ä¸‹ã™ã‚‹", reading: "ã¦ã„ã‹ã™ã‚‹" },
{ kanji: "ä½æ¸©", reading: "ã¦ã„ãŠã‚“" },
{ kanji: "æ•™ãˆã‚‹", reading: "ãŠã—ãˆã‚‹" },
{ kanji: "æ•™ä¼š", reading: "ãã‚‡ã†ã‹ã„" },
{ kanji: "æ•™è‚²ã™ã‚‹", reading: "ãã‚‡ã†ã„ãã™ã‚‹" },
{ kanji: "æ•™å®¤", reading: "ãã‚‡ã†ã—ã¤" },
{ kanji: "æœ", reading: "ã‚ã•" },
{ kanji: "æœæ—¥", reading: "ã‚ã•ã²" },
{ kanji: "æœé£Ÿ", reading: "ã¡ã‚‡ã†ã—ã‚‡ã" },
{ kanji: "æ˜¼", reading: "ã²ã‚‹" },
{ kanji: "æ˜¼å¯", reading: "ã²ã‚‹ã­" },
{ kanji: "æ˜¼é£Ÿ", reading: "ã¡ã‚…ã†ã—ã‚‡ã" },
{ kanji: "æ˜¼ä¼‘ã¿", reading: "ã²ã‚‹ã‚„ã™ã¿" },
{ kanji: "å¤œ", reading: "ã‚ˆã‚‹" },
{ kanji: "å¤œé£Ÿ", reading: "ã‚„ã—ã‚‡ã" },
{ kanji: "ä»Šå¤œ", reading: "ã“ã‚“ã‚„" },
{ kanji: "æ™©", reading: "ã°ã‚“" },
{ kanji: "ä»Šæ™©", reading: "ã“ã‚“ã°ã‚“" },
{ kanji: "æ™©å¾¡é£¯", reading: "ã°ã‚“ã”ã¯ã‚“" },
{ kanji: "æ¯æ—¥", reading: "ã¾ã„ã«ã¡" },
{ kanji: "æ¯é€±", reading: "ã¾ã„ã—ã‚…ã†" },
{ kanji: "æ¯æœˆ", reading: "ã¾ã„ (ã¤ã/ã’ã¤)" },
{ kanji: "æ¥é€±", reading: "ã‚‰ã„ã—ã‚…ã†" },
{ kanji: "é€±æœ«", reading: "ã—ã‚…ã†ã¾ã¤" },
{ kanji: "å…ˆé€±", reading: "ã›ã‚“ã—ã‚…ã†" },
{ kanji: "ä¸€é€±é–“", reading: "ã„ã£ã—ã‚…ã†ã‹ã‚“" },
{ kanji: "æœˆæ›œæ—¥", reading: "ã’ã¤ã‚ˆã†ã³" },
{ kanji: "ç«æ›œæ—¥", reading: "ã‹ã‚ˆã†ã³" },
{ kanji: "æ°´æ›œæ—¥", reading: "ã™ã„ã‚ˆã†ã³" },
{ kanji: "æœ¨æ›œæ—¥", reading: "ã‚‚ãã‚ˆã†ã³" }
    ],
    vocab2: [
{ kanji: "ä½œã‚‹", reading: "ã¤ãã‚‹" },
{ kanji: "ä½œæ–‡", reading: "ã•ãã¶ã‚“" },
{ kanji: "ä½œå“", reading: "ã•ãã²ã‚“" },
{ kanji: "å‹•ä½œ", reading: "ã©ã†ã•" },
{ kanji: "æ³³ã", reading: "ãŠã‚ˆã" },
{ kanji: "æ°´æ³³", reading: "ã™ã„ãˆã„" },
{ kanji: "æ²¹", reading: "ã‚ã¶ã‚‰" },
{ kanji: "æ²¹çµµ", reading: "ã‚ã¶ã‚‰ãˆ" },
{ kanji: "çŸ³æ²¹", reading: "ã›ãã‚†" },
{ kanji: "æµ·", reading: "ã†ã¿" },
{ kanji: "æµ·å¤–", reading: "ã‹ã„ãŒã„" },
{ kanji: "æ—¥æœ¬æµ·", reading: "ã«ã»ã‚“ã‹ã„" },
{ kanji: "æµ·æ°´", reading: "ã‹ã„ã™ã„" },
{ kanji: "é…’", reading: "ã•ã‘" },
{ kanji: "æ—¥æœ¬é…’", reading: "ã«ã»ã‚“ã—ã‚…" },
{ kanji: "é…’å±‹", reading: "ã•ã‹ã‚„" },
{ kanji: "æ´‹é…’", reading: "ã‚ˆã†ã—ã‚…" },
{ kanji: "å¾…ã¤", reading: "ã¾ã¤" },
{ kanji: "å¾…åˆå®¤", reading: "ã¾ã¡ã‚ã„ã—ã¤" },
{ kanji: "æ‹›å¾…ã™ã‚‹", reading: "ã—ã‚‡ã†ãŸã„ã™ã‚‹" },
{ kanji: "å­¦æ ¡", reading: "ãŒã£ã“ã†" },
{ kanji: "æ ¡é•·", reading: "ã“ã†ã¡ã‚‡ã†" },
{ kanji: "é«˜æ ¡ç”Ÿ", reading: "ã“ã†ã“ã†ã›ã„" },
{ kanji: "è¨€ã†", reading: "ã„ã†" },
{ kanji: "è¨€è‘‰", reading: "ã“ã¨ã°" },
{ kanji: "è¨€èª", reading: "ã’ã‚“ã”" },
{ kanji: "ä¼è¨€", reading: "ã§ã‚“ã”ã‚“" }
    ],
    vocab3: [
{ kanji: "æ™‚è¨ˆ", reading: "ã¨ã‘ã„" },
{ kanji: "è¨ˆç”»ã™ã‚‹", reading: "ã‘ã„ã‹ãã™ã‚‹" },
{ kanji: "ä½“æ¸©è¨ˆ", reading: "ãŸã„ãŠã‚“ã‘ã„" },
{ kanji: "æ—¥æœ¬èª", reading: "ã«ã»ã‚“ã”" },
{ kanji: "è‹±èª", reading: "ãˆã„ã”" },
{ kanji: "ç‰©èª", reading: "ã‚‚ã®ãŒãŸã‚Š" },
{ kanji: "ã”é£¯", reading: "ã”ã¯ã‚“" },
{ kanji: "é£¯", reading: "ã‚ã—" },
{ kanji: "å¤•é£¯", reading: "ã‚†ã†ã¯ã‚“" },
{ kanji: "ãŠå®…", reading: "ãŠãŸã" },
{ kanji: "ä½å®…", reading: "ã˜ã‚…ã†ãŸã" },
{ kanji: "è‡ªå®…", reading: "ã˜ãŸã" },
{ kanji: "å¸°å®…ã™ã‚‹", reading: "ããŸãã™ã‚‹" },
{ kanji: "å®¢", reading: "ãã‚ƒã" },
{ kanji: "ä¹—å®¢", reading: "ã˜ã‚‡ã†ãã‚ƒã" },
{ kanji: "æ•™å®¤", reading: "ãã‚‡ã†ã—ã¤" },
{ kanji: "å®¤å†…", reading: "ã—ã¤ãªã„" },
{ kanji: "ç ”ç©¶å®¤", reading: "ã‘ã‚“ãã‚…ã†ã—ã¤" },
{ kanji: "å®¶", reading: "ã„ãˆ" },
{ kanji: "å¤§å®¶", reading: "ãŠãŠã‚„" },
{ kanji: "å®¶æ—", reading: "ã‹ãã" }
    ],
    vocab4: [
{ kanji: "è‹±å›½", reading: "ãˆã„ã“ã" },
{ kanji: "è‹±èª", reading: "ãˆã„ã”" },
{ kanji: "è‹±å’Œè¾å…¸", reading: "ãˆã„ã‚ã˜ã¦ã‚“" },
{ kanji: "è–¬", reading: "ãã™ã‚Š" },
{ kanji: "è–¬å±‹", reading: "ãã™ã‚Šã‚„" },
{ kanji: "ç›®è–¬", reading: "ã‚ãã™ã‚Š" },
{ kanji: "è–¬å±€", reading: "ã‚„ã£ãã‚‡ã" },
{ kanji: "ä¼šã†", reading: "ã‚ã†" },
{ kanji: "ä¼šè©±", reading: "ã‹ã„ã‚" },
{ kanji: "ä¼šç¤¾", reading: "ã‹ã„ã—ã‚ƒ" },
{ kanji: "ä»Š", reading: "ã„ã¾" },
{ kanji: "ä»Šæœˆ", reading: "ã“ã‚“ã’ã¤" },
{ kanji: "ä»Šå¹´", reading: "ã“ã¨ã—" },
{ kanji: "ä»Šæ—¥", reading: "ãã‚‡ã†" },
{ kanji: "é›ª", reading: "ã‚†ã" },
{ kanji: "é›ªå›½", reading: "ã‚†ããã«" },
{ kanji: "æ›‡", reading: "ãã‚‚" },
{ kanji: "é›»æ°—", reading: "ã§ã‚“ã" },
{ kanji: "é›»è©±", reading: "ã§ã‚“ã‚" },
{ kanji: "é›»è»Š", reading: "ã§ã‚“ã—ã‚ƒ" },
{ kanji: "å£²ã‚‹", reading: "ã†ã‚‹" },
{ kanji: "å£²åº—", reading: "ã°ã„ã¦ã‚“" },
{ kanji: "å£²ã‚Šå ´", reading: "ã†ã‚Šã°" }
    ],
    vocab5: [
{ kanji: "åºƒã„", reading: "ã²ã‚ã„" },
{ kanji: "åºƒå³¶", reading: "ã²ã‚ã—ã¾" },
{ kanji: "åºƒã•", reading: "ã²ã‚ã•" },
{ kanji: "åºƒå‘Š", reading: "ã“ã†ã“ã" },
{ kanji: "åº—", reading: "ã¿ã›" },
{ kanji: "æ›¸åº—", reading: "ã—ã‚‡ã¦ã‚“" },
{ kanji: "åº—å“¡", reading: "ã¦ã‚“ã„ã‚“" },
{ kanji: "æœ¬åº—", reading: "ã»ã‚“ã¦ã‚“" },
{ kanji: "ä¸€åº¦", reading: "ã„ã¡ã©" },
{ kanji: "æ¸©åº¦", reading: "ãŠã‚“ã©" },
{ kanji: "ä»Šåº¦", reading: "ã“ã‚“ã©" },
{ kanji: "é€Ÿåº¦", reading: "ããã©" },
{ kanji: "ç—…æ°—", reading: "ã³ã‚‡ã†ã" },
{ kanji: "ç—…é™¢", reading: "ã³ã‚‡ã†ã„ã‚“" },
{ kanji: "ç—…äºº", reading: "ã³ã‚‡ã†ã«ã‚“" },
{ kanji: "ç–²ã‚Œã‚‹", reading: "ã¤ã‹ã‚Œã‚‹" },
{ kanji: "ç–²ã‚Œ", reading: "ã¤ã‹ã‚Œ" },
{ kanji: "ç—›ã„", reading: "ã„ãŸã„" },
{ kanji: "ç—›ã¿æ­¢ã‚", reading: "ã„ãŸã¿ã©ã‚" },
{ kanji: "ç—›ã‚€", reading: "ã„ãŸã‚€" },
{ kanji: "é ­ç—›", reading: "ãšã¤ã†" }
    ]
  };

  let mainArray = [];
  let currentCategory = "";
  let score = 0;
  let answered = [];
  let shuffledQuestions = [];
  let currentQuestion = {};

  function selectCategory(category) {
    currentCategory = category;
    document.getElementById("choiceScreen").classList.add("hidden");
    document.getElementById("checkboxScreen").classList.remove("hidden");
    buildCheckboxes();
  }

  function buildCheckboxes() {
    const container = document.getElementById("checkboxContainer");
    container.innerHTML = "";
    const sets = currentCategory === "kanji" ? kanjiSets : vocabSets;
    container.innerHTML += `<label><input type="checkbox" id="all" onchange="toggleAll(this)"> All</label>`;
    Object.keys(sets).forEach((key, i) => {
      const label = currentCategory === "kanji" ? `N4_Week ${i+2}` : `Lesson ${i+26}`;
      container.innerHTML += `<label><input type="checkbox" class="setBox" value="${key}"> ${label}</label>`;
    });
  }

  function toggleAll(allBox) {
    document.querySelectorAll(".setBox").forEach(cb => cb.checked = allBox.checked);
  }

  function buildMainArray() {
    mainArray = [];
    const sets = currentCategory === "kanji" ? kanjiSets : vocabSets;
    document.querySelectorAll(".setBox:checked").forEach(cb => {
      mainArray.push(...sets[cb.value]);
    });
  }

  function startFromCheckbox() {
    buildMainArray();
    if (mainArray.length === 0) {
      alert("Please select at least one option!");
      return;
    }
    document.getElementById("checkboxScreen").classList.add("hidden");
    document.getElementById("gameScreen").classList.remove("hidden");
    resetGame();
  }

  function resetGame() {
    score = 0;
    answered = [];
    shuffledQuestions = shuffle([...mainArray]);
    document.getElementById("score").textContent = `Score: ${score}`;
    document.getElementById("feedback").textContent = "";
    document.getElementById("kanji").textContent = "?";
    pickQuestion();
  }

  function pickQuestion() {
    if (answered.length === mainArray.length) {
      document.getElementById("kanji").textContent = "ğŸ‰";
      document.getElementById("choices").innerHTML = "";
      document.getElementById("feedback").textContent = "Congratulations! You answered all correctly!";
      return;
    }

    if (shuffledQuestions.length === 0) {
      shuffledQuestions = shuffle(mainArray.filter(k => !answered.includes(k.kanji)));
    }

    currentQuestion = shuffledQuestions.pop();
    document.getElementById("kanji").textContent = currentQuestion.kanji;

    const otherReadings = shuffle(mainArray.filter(k => k.reading !== currentQuestion.reading));
    const options = shuffle([
      currentQuestion.reading,
      otherReadings[0]?.reading || currentQuestion.reading,
      otherReadings[1]?.reading || currentQuestion.reading
    ]);

    const choicesDiv = document.getElementById("choices");
    choicesDiv.innerHTML = "";
    options.forEach(option => {
      const btn = document.createElement("button");
      btn.textContent = option;
      btn.classList.add("choice-option");
      btn.onclick = () => checkAnswer(option);
      choicesDiv.appendChild(btn);
    });
  }

  function checkAnswer(answer) {
    const feedback = document.getElementById("feedback");
    if (answer === currentQuestion.reading) {
      score++;
      if (!answered.includes(currentQuestion.kanji)) answered.push(currentQuestion.kanji);
      feedback.textContent = "Correct!";
      document.getElementById("score").textContent = `Score: ${score}`;
      setTimeout(() => {
        feedback.textContent = "";
        pickQuestion();
      }, 500); // âœ… 0.5s for correct
    } else {
      feedback.textContent = `Wrong! Correct was: ${currentQuestion.reading}`;
      setTimeout(() => {
        feedback.textContent = "";
        pickQuestion();
      }, 1000); // âœ… 1s for wrong
    }
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function goBackToCheckboxes() {
    document.getElementById("gameScreen").classList.add("hidden");
    document.getElementById("checkboxScreen").classList.remove("hidden");
  }

  function goBackToChoice() {
    document.getElementById("checkboxScreen").classList.add("hidden");
    document.getElementById("choiceScreen").classList.remove("hidden");
  }
</script>
</body>
</html>
